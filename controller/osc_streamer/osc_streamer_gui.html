<html>
    <head>
      <style>
          body {
              background-color: lightgrey;
              padding: 10px;
          }
      </style>
    </head>
    <body>
        <label for="ipAddress">Server Address:</label>
        <input type="text" id="ipAddress" name="ipAddress"><br><br>
        <label for="port">Port:</label>
        <input type="text" id="port" name="port"><br><br>
        <label for="oscAddress">OSC Path:</label>
        <input type="text" id="oscAddress" name="oscAddress"><br><br>
        <label for="minValue">Minimum Value:</label>
        <input type="text" id="minValue" name="minValue"><br><br>
        <label for="maxValue">Maximum Value:</label>
        <input type="text" id="maxValue" name="maxValue"><br><br>
        <button id="saveButton" onclick='updateSettings()'>Save</button>
    </body>
    <script>

        function updateSettings(){
            var xmlhttp=new XMLHttpRequest();
            xmlhttp.open("POST", location.origin+"/updateSettings", true);
            xmlhttp.setRequestHeader("content-type", "application/json");
            var payload=JSON.stringify({
                "ipAddress":document.getElementById('ipAddress').value,
                "port":document.getElementById('port').value,
                "oscAddress": document.getElementById('oscAddress').value,
                "minValue":document.getElementById('minValue').value,
                "maxValue": document.getElementById('maxValue').value
            });
            xmlhttp.send(payload);
            xmlhttp.onload = function(e){
                console.log("updatedSettings "+xmlhttp.status);
                if(xmlhttp.status==200 && document.getElementById('saveButton').style.backgroundColor!='green'){
                    document.getElementById('saveButton').style.backgroundColor='green';
                    setTimeout(function(){
                        document.getElementById('saveButton').style.backgroundColor='rgb(239, 239, 239)';
                    },2000);
                }
            }
        }
      
        window.onload = (event) => {
            var xmlhttp=new XMLHttpRequest();
            xmlhttp.open("GET", location.origin+"/recallSettings", true);
            xmlhttp.send();
            xmlhttp.onload = function(e){
                console.log(xmlhttp.response);
                document.getElementById('port').value=JSON.parse(xmlhttp.response).port;
                document.getElementById('ipAddress').value=JSON.parse(xmlhttp.response).ipAddress;
                document.getElementById('oscAddress').value=JSON.parse(xmlhttp.response).oscAddress;
                document.getElementById('minValue').value=JSON.parse(xmlhttp.response).minValue;
                document.getElementById('maxValue').value=JSON.parse(xmlhttp.response).maxValue;
            }
        };
    
    </script>
</html>